<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Post-Interaction Measures Predicting Actor, Partner, and Dyadic Desire.R â€“ ERROR review or Joel et al.&nbsp;(2017)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ERROR review or Joel et al.&nbsp;(2017)</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/FlorianPargent/error-review_Joel_2017" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Post-Interaction Measures Predicting Actor, Partner, and Dyadic Desire.R</h1>
<p class="subtitle lead">This script computes results from the <strong>Subsidiary random forests analyses</strong> section and <strong>Table 4</strong> in the manuscript.</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tree); <span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VSURF)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">############## SAMPLE A########################</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">#####Post-Interaction Relationship Analyses#####</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">####Male</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>PostI_malerel_SampleA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 1 Post-Interaction predicting Male Dyadic Desire, Sample A.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>SampleA_malerel_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>PostI_malerel_SampleA, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 66.6 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 36 variables)
Estimated computational time (on one core): between 9.4 sec. and  143.6 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |==============                                                        |  19%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |=====================                                                 |  31%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |=================================================                     |  69%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 18 variables)
Maximum estimated computational time (on one core): 40.5 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(DiggingRel ~ ., data = PostI_malerel_SampleA, na.action = na.omit, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleA_malerel_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 2.7 mins 

 VSURF selected: 
    36 variables at thresholding step (in 1.2 mins)
    18 variables at interpretation step (in 1.3 mins)
    5 variables at prediction step (in 10.4 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>SampleA_malerel_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3 13  5 19  9 21 17 31  4 25  1 29 18  7 15 22 33  6 27 10 28 32  2 20 35
[26] 26 14 11 23 30 34 12  8 36 24 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>SampleA_malerel_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3 13  5 19  9 21 17 31  4 25  1 29 18  7 15 22 33  6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>SampleA_malerel_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3 19 25  7  6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A male rel model, threshold variables</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.thresdata <span class="ot">&lt;-</span> PostI_malerel_SampleA[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">13</span>,<span class="dv">5</span>,<span class="dv">19</span>,<span class="dv">9</span>,<span class="dv">21</span>,<span class="dv">17</span>,<span class="dv">4</span>,<span class="dv">31</span>,<span class="dv">25</span>,<span class="dv">1</span>,<span class="dv">29</span>,<span class="dv">18</span>,<span class="dv">7</span>,<span class="dv">22</span>,<span class="dv">33</span>,<span class="dv">15</span>,<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">27</span>,<span class="dv">2</span>,<span class="dv">32</span>,<span class="dv">20</span>,<span class="dv">28</span>,<span class="dv">35</span>,<span class="dv">26</span>,<span class="dv">14</span>,<span class="dv">23</span>,<span class="dv">11</span>,<span class="dv">30</span>,<span class="dv">34</span>,<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">36</span>,<span class="dv">16</span>,<span class="dv">24</span>,<span class="dv">37</span>)]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleA_malerel.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingRel ~ ., data = SampleA_malerel.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 12

          Mean of squared residuals: 1.349298
                    % Var explained: 26.44</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_malerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               %IncMSE IncNodePurity
Chemis       73.843177     188.30698
PhysHot      67.955085     124.53172
pDigging     34.826782      64.24601
Warmth       38.291338      75.23933
PercPop      38.095663      58.59400
Domin        35.043938      45.70033
Vitality     28.387532      74.45612
FChemis      27.769170      42.11969
IFWarmth     32.150836      41.75927
IFPhysHot    28.525869      49.46788
Inter        22.500209      52.22982
IFVitality   28.579427      41.56897
FVitality    23.770436      37.85307
Deplet       21.392446      50.66438
FDomin       24.598940      34.75663
IFDomin      24.304438      35.49665
EarnAmbit    21.839916      38.32471
FpDigging    20.319224      44.94130
FPercPop     17.527953      33.88172
IFEarnAmbit  13.897965      37.87290
FInter       13.405712      33.60918
IFFWarmth    16.210063      31.05511
FWarmth      15.548654      33.07347
IFFEarnAmbit 14.620595      38.80544
IFIntell     15.488657      25.16088
IFFPhysHot   12.839931      35.65141
FPhysHot     14.236168      29.49253
Intell       11.286791      19.90492
PercDesp      9.739973      40.55644
IFFVitality  12.491446      33.14554
IFFDomin      8.309675      24.52451
FPercDesp     8.204977      37.17495
FDeplet       6.749766      35.86372
IFFIntell     9.091738      19.20709
FEarnAmbit    5.728680      28.35982
FIntell       4.610854      18.01130</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_malerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A male rel model, interpretation variables</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.interpdata <span class="ot">&lt;-</span> PostI_malerel_SampleA[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">13</span>,<span class="dv">5</span>,<span class="dv">19</span>,<span class="dv">9</span>,<span class="dv">21</span>,<span class="dv">17</span>,<span class="dv">4</span>,<span class="dv">31</span>,<span class="dv">25</span>,<span class="dv">1</span>,<span class="dv">29</span>,<span class="dv">18</span>,<span class="dv">7</span>,<span class="dv">22</span>,<span class="dv">33</span>,<span class="dv">15</span>,<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">37</span>)]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleA_malerel.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingRel ~ ., data = SampleA_malerel.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 6

          Mean of squared residuals: 1.348458
                    % Var explained: 26.51</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_malerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            %IncMSE IncNodePurity
Chemis     72.34175     207.91749
PhysHot    74.80800     144.52091
pDigging   38.54589      87.47276
Warmth     47.71944      99.77883
PercPop    42.61551      85.83518
Domin      40.31327      71.19321
Vitality   29.48741      97.38218
FChemis    30.74820      74.47978
IFWarmth   42.21364      71.91176
IFPhysHot  34.33856      76.91219
Inter      27.10699      77.51993
IFVitality 40.45980      69.20979
FVitality  29.55902      67.65172
Deplet     25.95532      74.32233
FDomin     29.33607      62.27329
IFDomin    32.20213      60.90105
EarnAmbit  25.92128      64.78560
FpDigging  20.11984      77.71650
FPercPop   22.68408      63.99970</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_malerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A male rel model, prediction variables</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.preddata <span class="ot">&lt;-</span> PostI_malerel_SampleA[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">19</span>,<span class="dv">21</span>,<span class="dv">17</span>,<span class="dv">4</span>,<span class="dv">37</span>)]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.predmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleA_malerel.preddata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>SampleA_malerel.predmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingRel ~ ., data = SampleA_malerel.preddata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 1.428539
                    % Var explained: 21.45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_malerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          %IncMSE IncNodePurity
Chemis   95.85781      326.8006
Warmth   73.08904      251.9906
Domin    79.72234      224.0953
Vitality 61.50769      239.2188
FChemis  26.42462      215.7126</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_malerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">######female</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>PostI_femalerel_SampleA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 1 Post-Interaction predicting Female Dyadic Desire, Sample A.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>PostI_femalerel_SampleA, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 62.2 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 34 variables)
Estimated computational time (on one core): between 8.8 sec. and  120 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |============                                                          |  18%
  |                                                                            
  |==============                                                        |  21%
  |                                                                            
  |================                                                      |  24%
  |                                                                            
  |===================                                                   |  26%
  |                                                                            
  |=====================                                                 |  29%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |=================================================                     |  71%
  |                                                                            
  |===================================================                   |  74%
  |                                                                            
  |======================================================                |  76%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 11 variables)
Maximum estimated computational time (on one core): 14.3 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(FDiggingRel ~ ., data = PostI_femalerel_SampleA, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleA_femalerel_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 2.3 mins 

 VSURF selected: 
    34 variables at thresholding step (in 1.1 mins)
    11 variables at interpretation step (in 1.1 mins)
    1 variables at prediction step (in 4.9 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4 14  2 18 20  3 10 22  6 17 29 21 25 30 26  9  1  8 32 33  7  5 13 19 11
[26] 35 31 12 34 16 27 24 15 23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4 14  2 18 20  3 10 22  6 17 29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A female rel model, threshold variables</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.thresdata <span class="ot">&lt;-</span> PostI_femalerel_SampleA[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">14</span>,<span class="dv">2</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">22</span>,<span class="dv">6</span>,<span class="dv">17</span>,<span class="dv">29</span>,<span class="dv">21</span>,<span class="dv">25</span>,<span class="dv">26</span>,<span class="dv">30</span>,<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">32</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">33</span>,<span class="dv">5</span>,<span class="dv">31</span>,<span class="dv">11</span>,<span class="dv">35</span>,<span class="dv">12</span>,<span class="dv">34</span>,<span class="dv">27</span>,<span class="dv">16</span>,<span class="dv">24</span>,<span class="dv">15</span>,<span class="dv">23</span>,<span class="dv">36</span>,<span class="dv">37</span>)]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleA_femalerel.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingRel ~ ., data = SampleA_femalerel.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 11

          Mean of squared residuals: 1.586394
                    % Var explained: 23.52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_femalerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              %IncMSE IncNodePurity
FChemis     70.911306     204.83183
FPhysHot    53.175430     117.78928
FInter      46.876237      87.40689
FVitality   34.393775      93.45587
FWarmth     40.683850      79.51073
Chemis      29.751256      65.47729
FPercPop    26.897118      70.37113
FDomin      26.116868      46.68235
FpDigging   24.450221      49.05474
Vitality    23.356285      46.44153
IFVitality  18.587972      45.78021
Domin       18.151253      41.56345
IFPhysHot   19.053871      47.82162
IFFPhysHot  17.546843      45.74812
IFFVitality 15.962422      38.12130
Inter       17.613402      41.32485
PercPop     16.179195      51.49480
FDeplet     11.263953      55.99980
IFFWarmth   13.212113      42.62355
Deplet      13.698147      41.89240
PhysHot     14.165391      47.82791
Warmth      12.551956      45.29963
IFDomin     16.288541      33.16759
pDigging    12.971063      41.09495
IFWarmth    10.131991      36.14761
PercDesp    10.852515      44.74643
IFIntell    14.502045      28.05100
FPercDesp   10.555841      44.18348
IFFDomin    11.101720      33.16454
IFEarnAmbit  8.681524      35.81336
FEarnAmbit   7.437514      45.89652
FIntell      7.674721      28.46961
EarnAmbit    5.732426      42.21044
Intell       5.671751      24.10902
IFFIntell   -0.999134      25.95964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_femalerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A female rel model, interpretation variables</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.interpdata <span class="ot">&lt;-</span> PostI_femalerel_SampleA[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">14</span>,<span class="dv">2</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">22</span>,<span class="dv">6</span>,<span class="dv">17</span>,<span class="dv">29</span>,<span class="dv">21</span>,<span class="dv">25</span>,<span class="dv">26</span>,<span class="dv">30</span>,<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">32</span>,<span class="dv">37</span>)]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleA_femalerel.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingRel ~ ., data = SampleA_femalerel.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 6

          Mean of squared residuals: 1.580602
                    % Var explained: 23.78</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_femalerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             %IncMSE IncNodePurity
FChemis     74.63071     228.95032
FPhysHot    58.13898     145.74080
FInter      53.87925     114.32692
FVitality   37.26032     120.63059
FWarmth     46.98962     111.12483
Chemis      36.10022     104.44337
FPercPop    25.27300      93.98481
FDomin      37.54362      75.65395
FpDigging   29.01923      78.67540
Vitality    25.71310      79.44096
IFVitality  20.35067      79.59716
Domin       21.55569      72.56932
IFPhysHot   17.92239      84.84006
IFFPhysHot  25.00004      75.31973
IFFVitality 23.14175      65.28010
Inter       20.21167      72.41375
PercPop     18.29310      88.71590
FDeplet     13.71897      82.27313
IFFWarmth   19.13564      72.91836</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_femalerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A female rel model, prediction variables</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.preddata <span class="ot">&lt;-</span> PostI_femalerel_SampleA[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">37</span>)]</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.predmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleA_femalerel.preddata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>SampleA_femalerel.predmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingRel ~ ., data = SampleA_femalerel.preddata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 1.715788
                    % Var explained: 16.55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_femalerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         %IncMSE IncNodePurity
FChemis 422.6742      446.8224</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_femalerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####Post-Interaction Actor Analyses#####</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>PostI_Actor_SampleA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 2 Post-Interaction predicting Actor, Sample A.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>SampleA_Actor_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(CombinedDiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>PostI_Actor_SampleA, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 6.4 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 21 variables)
Estimated computational time (on one core): between 1.7 sec. and  6.5 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 6 variables)
Maximum estimated computational time (on one core): 0.7 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(CombinedDiggingActorGM ~ ., data = PostI_Actor_SampleA, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleA_Actor_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 11.3 secs 

 VSURF selected: 
    21 variables at thresholding step (in 6.8 secs)
    6 variables at interpretation step (in 3.9 secs)
    3 variables at prediction step (in 0.6 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>SampleA_Actor_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  8  3 10  2 12  6 11 23  4 25  9 14 22 16  7 17 13  5 36 15 33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>SampleA_Actor_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8  3 10  2 12  6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>SampleA_Actor_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A actor model, threshold variables</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>SampleA_ActorGM.thresdata <span class="ot">&lt;-</span> PostI_Actor_SampleA[<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">12</span>,<span class="dv">6</span>,<span class="dv">11</span>,<span class="dv">23</span>,<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">9</span>,<span class="dv">14</span>,<span class="dv">22</span>,<span class="dv">16</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">17</span>,<span class="dv">13</span>,<span class="dv">36</span>,<span class="dv">15</span>,<span class="dv">33</span>,<span class="dv">24</span>,<span class="dv">20</span>,<span class="dv">28</span>,<span class="dv">31</span>,<span class="dv">34</span>,<span class="dv">19</span>,<span class="dv">29</span>,<span class="dv">38</span>)]</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>SampleA_Actor.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(CombinedDiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>SampleA_ActorGM.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>SampleA_Actor.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = CombinedDiggingActorGM ~ ., data = SampleA_ActorGM.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 9

          Mean of squared residuals: 0.2144828
                    % Var explained: 79.28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_Actor.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         %IncMSE IncNodePurity
PhysHotActorGM       98.07303909    49.1727050
ChemisActorGM        74.97668216    38.3131007
VitalityActorGM      33.01378819    16.9846856
InterActorGM         29.10893376    10.0630967
DominActorGM         20.65100129     8.3985295
PercPopActorGM       19.28116970     4.6854550
WarmthActorGM        15.60857569     5.0908504
FPercPopPartnerGM    15.38487483     2.4773153
pDiggingActorGM      14.00968984     2.4017931
FPhysHotPartnerGM    14.26385265     2.2511657
EarnAmbitActorGM      8.31268566     3.0679345
IFPhysHotActorGM      7.56027896     1.8619093
FDepletPartnerGM      6.93685261     1.3197701
IFVitalityActorGM     6.29770222     1.9018653
PercDespActorGM       6.70484397     1.6712709
DepletActorGM         4.21947421     1.6742057
IFWarmthActorGM       4.14851363     1.7727467
IntellActorGM         4.21710650     1.8245055
IFFIntellPartnerGM    4.87430759     1.1751007
IFEarnAmbitActorGM    3.94980411     1.2817464
IFFVitalityPartnerGM  0.15743487     1.2883953
FPercDespPartnerGM    1.52554275     1.3765618
FChemisPartnerGM     -0.04371625     0.9072373
FWarmthPartnerGM      2.93680665     0.8050317
IFFPhysHotPartnerGM   1.88997190     0.8977682
IFFWarmthPartnerGM    3.31720545     0.9083548
FInterPartnerGM       1.57530785     0.8942100
FDominPartnerGM       0.72988717     0.8603547</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_Actor.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A actor model, interpretation variables</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>SampleA_ActorGM.interpdata <span class="ot">&lt;-</span> PostI_Actor_SampleA[<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">12</span>,<span class="dv">6</span>,<span class="dv">38</span>)]</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>SampleA_Actor.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(CombinedDiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>SampleA_ActorGM.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>SampleA_Actor.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = CombinedDiggingActorGM ~ ., data = SampleA_ActorGM.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 2

          Mean of squared residuals: 0.1871913
                    % Var explained: 81.92</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_Actor.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  %IncMSE IncNodePurity
PhysHotActorGM  117.33408     57.120793
ChemisActorGM    87.80307     45.280830
VitalityActorGM  36.60989     23.594932
InterActorGM     40.47274     16.143456
DominActorGM     19.14417     13.329786
PercPopActorGM   26.82536      8.727199</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_Actor.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A actor model, prediction variables</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>SampleA_ActorGM.preddata <span class="ot">&lt;-</span> PostI_Actor_SampleA[<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">38</span>)]</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>SampleA_Actor.predmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(CombinedDiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>SampleA_ActorGM.preddata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>SampleA_Actor.predmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = CombinedDiggingActorGM ~ ., data = SampleA_ActorGM.preddata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 0.1752169
                    % Var explained: 83.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_Actor.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 %IncMSE IncNodePurity
PhysHotActorGM 128.78971      65.09707
ChemisActorGM  102.93648      58.53461
InterActorGM    62.18773      38.80862</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_Actor.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####Post-Interaction Partner Analyses#####</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>PostI_Partner_SampleA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 2 Post-Interaction predicting Partner, Sample A.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>SampleA_Partner_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(CombinedDiggingPartnerGM<span class="sc">~</span>., <span class="at">data=</span>PostI_Partner_SampleA, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 6 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 21 variables)
Estimated computational time (on one core): between 1.9 sec. and  6.3 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 3 variables)
Maximum estimated computational time (on one core): 0.3 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(CombinedDiggingPartnerGM ~ ., data = PostI_Partner_SampleA, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleA_Partner_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 10.5 secs 

 VSURF selected: 
    21 variables at thresholding step (in 6.4 secs)
    3 variables at interpretation step (in 3.8 secs)
    3 variables at prediction step (in 0.3 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>SampleA_Partner_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 25 23 20 27 29 19 28 22 34 21 31 33 24 35 36 30 32 26  8 37 18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>SampleA_Partner_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25 23 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>SampleA_Partner_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25 23 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A Partner model, threshold variables</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>SampleA_PartnerGM.thresdata <span class="ot">&lt;-</span> PostI_Partner_SampleA[<span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">23</span>,<span class="dv">20</span>,<span class="dv">27</span>,<span class="dv">29</span>,<span class="dv">19</span>,<span class="dv">28</span>,<span class="dv">22</span>,<span class="dv">34</span>,<span class="dv">21</span>,<span class="dv">31</span>,<span class="dv">24</span>,<span class="dv">33</span>,<span class="dv">35</span>,<span class="dv">30</span>,<span class="dv">32</span>,<span class="dv">36</span>,<span class="dv">26</span>,<span class="dv">8</span>,<span class="dv">18</span>,<span class="dv">37</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">38</span>)]</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>SampleA_Partner.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(CombinedDiggingPartnerGM<span class="sc">~</span>., <span class="at">data=</span>SampleA_PartnerGM.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>SampleA_Partner.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = CombinedDiggingPartnerGM ~ ., data = SampleA_PartnerGM.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 7

          Mean of squared residuals: 0.109392
                    % Var explained: 93.47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_Partner.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        %IncMSE IncNodePurity
FPhysHotPartnerGM     85.633618    71.5733619
FPercPopPartnerGM     72.145239    71.9814546
FChemisPartnerGM      56.619689    43.1818219
FVitalityPartnerGM    31.588379    19.1840344
FDominPartnerGM       34.974359    21.0869321
FInterPartnerGM       22.903711     7.7986853
FWarmthPartnerGM      24.169303     5.6357451
FDepletPartnerGM      19.780613     6.4428428
IFFWarmthPartnerGM    18.179069     3.4597736
FpDiggingPartnerGM    18.218401     2.3564248
IFFPhysHotPartnerGM   14.895839     2.0528694
FPercDespPartnerGM    11.888488     1.7451285
IFFVitalityPartnerGM   9.454009     1.2732109
IFFDominPartnerGM     10.747242     1.2491227
FIntellPartnerGM      10.202322     1.3106266
IFFEarnAmbitPartnerGM  7.573569     1.3019100
IFFIntellPartnerGM    10.395126     1.0574707
FEarnAmbitPartnerGM    6.601252     1.1968129
PhysHotActorGM         6.313206     1.3169487
IFDominActorGM         3.162519     0.9733068
IFIntellActorGM        1.948691     1.0220391
IFPhysHotActorGM       3.791922     0.8940780
IFVitalityActorGM      1.251598     0.9402682</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_Partner.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample A partner model, interpretation variables</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>SampleA_PartnerGM.interpdata <span class="ot">&lt;-</span> PostI_Partner_SampleA[<span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">23</span>,<span class="dv">20</span>,<span class="dv">38</span>)]</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>SampleA_Partner.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(CombinedDiggingPartnerGM<span class="sc">~</span>., <span class="at">data=</span>SampleA_PartnerGM.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>SampleA_Partner.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = CombinedDiggingPartnerGM ~ ., data = SampleA_PartnerGM.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 0.09257421
                    % Var explained: 94.48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleA_Partner.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    %IncMSE IncNodePurity
FPhysHotPartnerGM  87.37504      91.66509
FPercPopPartnerGM  79.85265      89.73136
FChemisPartnerGM  103.39578      86.80520</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleA_Partner.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">############## SAMPLE B########################</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">#####Post-Interaction Relationship Analyses#####</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="do">####Male</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>PostI_malerel_SampleB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 1 Post-Interaction predicting Male Dyadic Desire, Sample B.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>SampleB_malerel_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>PostI_malerel_SampleB, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 76.4 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 39 variables)
Estimated computational time (on one core): between 10.5 sec. and  179.4 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |==============                                                        |  21%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 15 variables)
Maximum estimated computational time (on one core): 31 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(DiggingRel ~ ., data = PostI_malerel_SampleB, na.action = na.omit, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleB_malerel_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 3.1 mins 

 VSURF selected: 
    39 variables at thresholding step (in 1.3 mins)
    15 variables at interpretation step (in 1.6 mins)
    1 variables at prediction step (in 6.9 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>SampleB_malerel_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3 13  9 39  1  5 31 17 25  4 11 26 19 37 15 29  6 21 33 14 18 20 28 36 10
[26] 22  7 24 32 16 35 34 30 23 27  2 40  8 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>SampleB_malerel_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3 13  9 39  1  5 31 17 25  4 11 26 19 37 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>SampleB_malerel_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B male rel model, threshold variables</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.thresdata <span class="ot">&lt;-</span> PostI_malerel_SampleB[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">39</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">31</span>,<span class="dv">17</span>,<span class="dv">25</span>,<span class="dv">4</span>,<span class="dv">26</span>,<span class="dv">11</span>,<span class="dv">19</span>,<span class="dv">15</span>,<span class="dv">37</span>,<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">21</span>,<span class="dv">33</span>,<span class="dv">14</span>,<span class="dv">20</span>,<span class="dv">28</span>,<span class="dv">18</span>,<span class="dv">10</span>,<span class="dv">36</span>,<span class="dv">7</span>,<span class="dv">24</span>,<span class="dv">22</span>,<span class="dv">32</span>,<span class="dv">16</span>,<span class="dv">35</span>,<span class="dv">34</span>,<span class="dv">23</span>,<span class="dv">27</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">2</span>,<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">38</span>,<span class="dv">41</span>)]</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleB_malerel.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingRel ~ ., data = SampleB_malerel.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 13

          Mean of squared residuals: 1.167415
                    % Var explained: 28.65</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_malerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                %IncMSE IncNodePurity
Chemis       101.150668     235.16698
PhysHot       38.628766      84.67731
PercPop       34.317622      70.12082
PSAvoid       39.311747      43.10028
Inter         28.455053      75.05395
pDigging      30.675547      47.81228
IFWarmth      27.983423      40.84665
Vitality      21.285697      49.57273
IFPhysHot     24.324101      36.05260
FChemis       21.354024      37.55920
IFFPhysHot    21.963901      34.58680
PercDesp      19.308325      50.21738
Warmth        18.126477      42.31203
EarnAmbit     18.336483      34.66798
PSAnx         16.292710      31.80650
FpDigging     17.046272      33.81913
IFVitality    18.420317      31.22971
Domin         13.214962      41.59861
IFDomin       17.191177      30.75404
FPhysHot      14.347665      34.58392
FWarmth       16.923298      28.56028
IFFEarnAmbit  14.677125      33.21806
FVitality     14.847796      30.86572
FPercPop      11.222124      32.70433
IFFIntell     14.525183      26.51770
Deplet        11.992009      28.05246
FIntell       12.924523      27.53563
FDomin        12.125352      29.48495
IFFWarmth     12.245022      27.74731
FEarnAmbit    10.842256      31.00559
IFIntell       7.540064      28.54455
IFFDomin       9.213000      28.56555
Intell         9.530794      27.85792
IFEarnAmbit    8.556319      27.62289
IFFVitality    8.431127      23.72642
FPSAvoid      10.417468      19.07895
FInter         8.220133      19.27079
FPercDesp      5.970262      29.25415
FDeplet        7.575274      14.35157
FPSAnx         2.821936      18.19932</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_malerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B male rel model, interpretation variables</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.interpdata <span class="ot">&lt;-</span> PostI_malerel_SampleB[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">39</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">31</span>,<span class="dv">17</span>,<span class="dv">25</span>,<span class="dv">4</span>,<span class="dv">26</span>,<span class="dv">11</span>,<span class="dv">41</span>)]</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleB_malerel.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingRel ~ ., data = SampleB_malerel.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 4

          Mean of squared residuals: 1.148441
                    % Var explained: 29.48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_malerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             %IncMSE IncNodePurity
Chemis     116.28328     296.33255
PhysHot     47.28448     150.25288
PercPop     41.32967     129.57744
PSAvoid     57.87485      96.87942
Inter       41.37585     130.40236
pDigging    45.52469     105.64549
IFWarmth    44.33235     114.45885
Vitality    32.87915     115.09952
IFPhysHot   43.29306      97.77963
FChemis     20.33958     123.14507
IFFPhysHot  26.17422     110.50764
PercDesp    33.87844     117.83377</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_malerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B male rel model, prediction variables</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.preddata <span class="ot">&lt;-</span> PostI_malerel_SampleB[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">41</span>)]</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.predmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleB_malerel.preddata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>SampleB_malerel.predmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingRel ~ ., data = SampleB_malerel.preddata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 1.318841
                    % Var explained: 19.68</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_malerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        %IncMSE IncNodePurity
Chemis 482.1263      443.4025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_malerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">####Female</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>PostI_femalerel_SampleB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 1 Post-Interaction predicting Female Dyadic Desire, Sample B.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>PostI_femalerel_SampleB, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 77.1 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 40 variables)
Estimated computational time (on one core): between 10.8 sec. and  184.8 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |============                                                          |  18%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 19 variables)
Maximum estimated computational time (on one core): 45.2 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(FDiggingRel ~ ., data = PostI_femalerel_SampleB, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleB_femalerel_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 3.2 mins 

 VSURF selected: 
    40 variables at thresholding step (in 1.3 mins)
    19 variables at interpretation step (in 1.7 mins)
    2 variables at prediction step (in 8.8 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4 18 14  6 20 10 22 40  2 38 26 24 12  3 15 36 19 28  1 13 30 34 16 29  8
[26]  9 17 39 25 27 31 23 21 37  5 33 32 35 11  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4 18 14  6 20 10 22 40  2 38 26 24 12  3 15 36 19 28  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B female rel model, threshold variables</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.thresdata <span class="ot">&lt;-</span> PostI_femalerel_SampleB[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">18</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">22</span>,<span class="dv">40</span>,<span class="dv">2</span>,<span class="dv">38</span>,<span class="dv">26</span>,<span class="dv">24</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">36</span>,<span class="dv">28</span>,<span class="dv">19</span>,<span class="dv">1</span>,<span class="dv">34</span>,<span class="dv">30</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">29</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">27</span>,<span class="dv">17</span>,<span class="dv">25</span>,<span class="dv">23</span>,<span class="dv">39</span>,<span class="dv">21</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">37</span>,<span class="dv">35</span>,<span class="dv">5</span>,<span class="dv">33</span>,<span class="dv">11</span>,<span class="dv">7</span>,<span class="dv">41</span>)]</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleB_femalerel.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingRel ~ ., data = SampleB_femalerel.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 13

          Mean of squared residuals: 1.217781
                    % Var explained: 27.11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_femalerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                %IncMSE IncNodePurity
FChemis      103.132131     236.14055
FVitality     42.910287      89.75194
FPhysHot      49.261816     103.87762
FpDigging     44.014935      51.96716
FWarmth       38.596561      47.04766
FPercPop      36.561886      62.19018
FDomin        25.278441      62.07153
FPSAvoid      21.725311      54.53318
FInter        21.634327      34.45216
FPSAnx        23.302386      35.53683
IFFPhysHot    21.167518      35.05445
FIntell       18.013797      28.87305
FPercDesp     15.021454      40.50535
EarnAmbit     15.014407      38.21575
Chemis        14.265740      36.42548
IFFIntell     12.685140      28.67955
IFFEarnAmbit  13.057734      32.12354
Warmth        12.987181      31.11641
Inter         11.923816      30.06066
IFFDomin      11.998266      32.21615
IFFVitality   11.793888      27.58278
PhysHot       11.420240      31.89749
FEarnAmbit    12.440572      29.84593
IFVitality    11.644087      30.30870
FDeplet       13.541951      16.02688
PercPop       10.166482      37.52682
IFEarnAmbit   10.595889      28.39245
Vitality       9.346553      23.40418
IFPhysHot     10.735124      23.85695
Intell         8.497695      28.56257
PSAvoid       12.076032      23.58607
Domin          8.318782      28.47309
IFWarmth       6.273097      27.68421
IFFWarmth      8.413893      31.19193
PSAnx          8.379711      23.83983
IFIntell       7.778747      24.32952
pDigging       7.490647      23.47622
IFDomin        7.952264      26.85076
PercDesp       2.532953      32.63291
Deplet         4.436679      18.79144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_femalerel.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B female rel model, interpretation variables </span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.interpdata <span class="ot">&lt;-</span> PostI_femalerel_SampleB[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">18</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">22</span>,<span class="dv">40</span>,<span class="dv">2</span>,<span class="dv">38</span>,<span class="dv">26</span>,<span class="dv">24</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">36</span>,<span class="dv">28</span>,<span class="dv">19</span>,<span class="dv">1</span>,<span class="dv">41</span>)]</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleB_femalerel.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingRel ~ ., data = SampleB_femalerel.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 6

          Mean of squared residuals: 1.265107
                    % Var explained: 26.14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_femalerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               %IncMSE IncNodePurity
FChemis      105.52616     269.11693
FVitality     51.12924     117.84750
FPhysHot      58.03330     142.28616
FpDigging     49.02299      82.87614
FWarmth       47.78673      83.85001
FPercPop      38.93828      93.83663
FDomin        32.36595      98.06550
FPSAvoid      27.42195      79.84555
FInter        31.50195      58.63040
FPSAnx        29.02494      61.18355
IFFPhysHot    30.00158      69.70703
FIntell       24.75480      62.34672
FPercDesp     13.56409      73.62692
EarnAmbit     18.81932      80.94124
Chemis        10.79134      79.71670
IFFIntell     17.33766      58.97407
IFFEarnAmbit  18.89875      66.57854
Warmth        13.34199      71.52674
Inter         16.61852      58.32820</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_femalerel.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B female rel model, prediction variables </span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.preddata <span class="ot">&lt;-</span> PostI_femalerel_SampleB[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">41</span>)]</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.predmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingRel<span class="sc">~</span>., <span class="at">data=</span>SampleB_femalerel.preddata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>SampleB_femalerel.predmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingRel ~ ., data = SampleB_femalerel.preddata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 1.361627
                    % Var explained: 21.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_femalerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          %IncMSE IncNodePurity
FChemis 298.80947      506.4516
Inter    53.94947      117.9426</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_femalerel.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####Post-Interaction Actor Analyses#####</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>PostI_Actor_SampleB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 2 Post-Interaction predicting Actor, Sample B.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>SampleB_Actor_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(DiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>PostI_Actor_SampleB, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 8.2 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 26 variables)
Estimated computational time (on one core): between 2.6 sec. and  10.9 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 4 variables)
Maximum estimated computational time (on one core): 0.4 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(DiggingActorGM ~ ., data = PostI_Actor_SampleB, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleB_Actor_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 16 secs 

 VSURF selected: 
    26 variables at thresholding step (in 8.8 secs)
    4 variables at interpretation step (in 6.7 secs)
    3 variables at prediction step (in 0.5 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>SampleB_Actor_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 14  4 18 10  6 22 20 38 12 16 15 26  9 32 28 23 13 19 29  2 25 24 27 35 40
[26] 34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>SampleB_Actor_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14  4 18 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>SampleB_Actor_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14  4 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B actor model, threshold variables</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>SampleB_ActorGM.thresdata <span class="ot">&lt;-</span> PostI_Actor_SampleB[<span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">4</span>,<span class="dv">18</span>,<span class="dv">10</span>,<span class="dv">6</span>,<span class="dv">22</span>,<span class="dv">20</span>,<span class="dv">38</span>,<span class="dv">16</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">26</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">32</span>,<span class="dv">23</span>,<span class="dv">29</span>,<span class="dv">19</span>,<span class="dv">13</span>,<span class="dv">2</span>,<span class="dv">40</span>,<span class="dv">25</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">39</span>,<span class="dv">35</span>,<span class="dv">34</span>,<span class="dv">17</span>,<span class="dv">27</span>,<span class="dv">36</span>,<span class="dv">5</span>,<span class="dv">41</span>,<span class="dv">7</span>,<span class="dv">30</span>,<span class="dv">3</span>,<span class="dv">33</span>,<span class="dv">37</span>,<span class="dv">42</span>)]</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>SampleB_Actor.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>SampleB_ActorGM.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>SampleB_Actor.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingActorGM ~ ., data = SampleB_ActorGM.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 12

          Mean of squared residuals: 0.2384941
                    % Var explained: 72.31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_Actor.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           %IncMSE IncNodePurity
PhysHotActorGM        92.412701820    43.8750064
ChemisActorGM         69.959243377    31.1291084
VitalityActorGM       36.229646344    14.3542027
PercPopActorGM        38.079090148    11.6285868
pDiggingActorGM       19.705700886     4.0700489
DominActorGM          15.465898589     3.9364269
WarmthActorGM         14.437649327     4.3656247
PSAnxActorGM          16.676239221     3.4863119
EarnAmbitActorGM      10.062571630     4.8789216
PercDespActorGM       15.118314302     2.6648069
FPhysHotPartnerGM      8.680260106     1.6735874
IFPhysHotActorGM       6.903798036     1.6168185
FDepletPartnerGM       6.613906627     1.3509667
IFEarnAmbitActorGM     4.404848160     1.3201419
IFWarmthActorGM        3.571372928     1.3372653
FDominPartnerGM        4.004776898     1.2115183
IFFEarnAmbitPartnerGM  5.937439869     1.0737403
FVitalityPartnerGM     3.660809052     1.0160825
FPercDespPartnerGM     5.541532605     1.3935159
InterActorGM           5.171935649     1.1810183
PSAvoidActorGM         2.484981357     2.8135710
FIntellPartnerGM       4.744852019     1.0212105
IntellActorGM          5.130186949     1.6710967
FPercPopPartnerGM      3.591492769     0.9134172
FPSAnxPartnerGM        1.326384249     0.9647809
IFFDominPartnerGM      2.343343709     0.7763562
IFDominActorGM         2.816524915     0.8912192
FEarnAmbitPartnerGM    4.803623982     1.0156202
IFFPhysHotPartnerGM    1.502392444     1.0392027
IFIntellActorGM        2.072056687     1.0100049
FChemisPartnerGM       1.329426966     0.7237833
FPSAvoidPartnerGM      2.013231931     0.7890853
FpDiggingPartnerGM     0.994512980     0.7206956
IFVitalityActorGM      1.244013581     1.3703856
FInterPartnerGM        0.628849112     0.8875703
IFFWarmthPartnerGM     0.001650225     0.6233390
IFFIntellPartnerGM     0.594387350     0.6944524</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_Actor.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B actor model, interpretation variables</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>SampleB_ActorGM.interpdata <span class="ot">&lt;-</span> PostI_Actor_SampleB[<span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">4</span>,<span class="dv">18</span>,<span class="dv">10</span>,<span class="dv">42</span>)]</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>SampleB_Actor.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>SampleB_ActorGM.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>SampleB_Actor.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingActorGM ~ ., data = SampleB_ActorGM.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 0.209388
                    % Var explained: 76.25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_Actor.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 %IncMSE IncNodePurity
PhysHotActorGM  98.88278      46.30109
ChemisActorGM   84.96671      43.29523
VitalityActorGM 54.11715      33.63051
PercPopActorGM  63.89772      32.65873</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_Actor.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B actor model, prediction variables</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>SampleB_ActorGM.preddata <span class="ot">&lt;-</span> PostI_Actor_SampleB[<span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">4</span>,<span class="dv">10</span>,<span class="dv">42</span>)]</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>SampleB_Actor.predmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DiggingActorGM<span class="sc">~</span>., <span class="at">data=</span>SampleB_ActorGM.preddata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>SampleB_Actor.predmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = DiggingActorGM ~ ., data = SampleB_ActorGM.preddata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 0.1941393
                    % Var explained: 77.98</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_Actor.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 %IncMSE IncNodePurity
PhysHotActorGM 122.86700      60.24462
ChemisActorGM  109.45670      56.44707
PercPopActorGM  70.48677      40.02835</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_Actor.predmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####Post-Interaction Partner Analyses#####</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>PostI_Partner_SampleB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"Level 2 Post-Interaction predicting Partner, Sample B.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>SampleB_Partner_VSURF_post <span class="ot">&lt;-</span> <span class="fu">VSURF</span>(FDiggingPartnerGM<span class="sc">~</span>., <span class="at">data=</span>PostI_Partner_SampleB, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Thresholding step
Estimated computational time (on one core): 7.7 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%
Interpretation step (on 27 variables)
Estimated computational time (on one core): between 2.7 sec. and  11.6 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |======================================================================| 100%
Prediction step (on 3 variables)
Maximum estimated computational time (on one core): 0.3 sec.

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in VSURF.formula(FDiggingPartnerGM ~ ., data = PostI_Partner_SampleB, : VSURF with a formula-type call outputs selected variables
which are indices of the input matrix based on the formula:
you may reorder these to get indices of the original data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SampleB_Partner_VSURF_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 VSURF computation time: 15.2 secs 

 VSURF selected: 
    27 variables at thresholding step (in 8.2 secs)
    3 variables at interpretation step (in 6.7 secs)
    3 variables at prediction step (in 0.3 secs)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>SampleB_Partner_VSURF_post<span class="sc">$</span>varselect.thres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 15 11  5 19 39 41 23  7 21  3 31 33 13 27 35  9 25 37 29 36 34 32 28 18 10
[26] 26  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>SampleB_Partner_VSURF_post<span class="sc">$</span>varselect.interp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15 11  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>SampleB_Partner_VSURF_post<span class="sc">$</span>varselect.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15 11  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B Partner model, threshold variables</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>SampleB_PartnerGM.thresdata <span class="ot">&lt;-</span> PostI_Partner_SampleB[<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">11</span>,<span class="dv">5</span>,<span class="dv">19</span>,<span class="dv">39</span>,<span class="dv">41</span>,<span class="dv">23</span>,<span class="dv">7</span>,<span class="dv">21</span>,<span class="dv">3</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">13</span>,<span class="dv">27</span>,<span class="dv">35</span>,<span class="dv">9</span>,<span class="dv">25</span>,<span class="dv">37</span>,<span class="dv">34</span>,<span class="dv">29</span>,<span class="dv">36</span>,<span class="dv">18</span>,<span class="dv">32</span>,<span class="dv">28</span>,<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">26</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">42</span>)]</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>SampleB_Partner.thresmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingPartnerGM<span class="sc">~</span>., <span class="at">data=</span>SampleB_PartnerGM.thresdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>SampleB_Partner.thresmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingPartnerGM ~ ., data = SampleB_PartnerGM.thresdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 9

          Mean of squared residuals: 0.09183428
                    % Var explained: 92.74</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_Partner.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          %IncMSE IncNodePurity
FPhysHotPartnerGM     90.26350541    66.9477013
FPercPopPartnerGM     72.75082595    59.1127773
FChemisPartnerGM      58.22837482    31.9147936
FVitalityPartnerGM    38.80920888    17.4770958
FPSAnxPartnerGM       34.66316419    14.0153785
FPSAvoidPartnerGM     28.25033692     8.5192724
FDominPartnerGM       20.31626537     6.3401186
FpDiggingPartnerGM    26.44175569     3.9323491
FWarmthPartnerGM      18.62338672     2.1614708
FInterPartnerGM       13.82783712     1.7361438
IFFVitalityPartnerGM  13.29259244     2.0560235
IFFWarmthPartnerGM    13.52434772     1.8052629
FPercDespPartnerGM    12.27700442     1.4164486
IFFPhysHotPartnerGM   11.30780675     1.2663582
IFFDominPartnerGM      9.82783672     1.0392341
FDepletPartnerGM       5.41069730     0.9852467
FIntellPartnerGM       5.85725507     0.7906707
IFFIntellPartnerGM     2.96252051     0.9374073
IFDominActorGM         4.89093512     0.7152648
IFFEarnAmbitPartnerGM  3.38608673     1.0107717
IFIntellActorGM        2.02688833     0.6455171
VitalityActorGM        0.45644515     0.7469526
IFWarmthActorGM        3.54421645     0.5137112
IFEarnAmbitActorGM     1.23764719     0.5969621
InterActorGM           0.91716011     0.6717666
PercPopActorGM         0.07838673     0.7913518
IFPhysHotActorGM      -1.12393339     0.6499352
FEarnAmbitPartnerGM    1.04664829     0.7552856
gender                 1.05976111     0.1398040</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_Partner.thresmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample B partner model, interpretation variables</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>SampleB_partnerGM.interpdata <span class="ot">&lt;-</span> PostI_Partner_SampleB[<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">11</span>,<span class="dv">5</span>,<span class="dv">42</span>)]</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">605</span>)</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>SampleB_partner.interpmodel <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(FDiggingPartnerGM<span class="sc">~</span>., <span class="at">data=</span>SampleB_partnerGM.interpdata, <span class="at">importance=</span>T, <span class="at">na.action=</span>na.omit, <span class="at">ntree=</span><span class="dv">5000</span>)</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>SampleB_partner.interpmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = FDiggingPartnerGM ~ ., data = SampleB_partnerGM.interpdata,      importance = T, ntree = 5000, na.action = na.omit) 
               Type of random forest: regression
                     Number of trees: 5000
No. of variables tried at each split: 1

          Mean of squared residuals: 0.07778988
                    % Var explained: 93.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(SampleB_partner.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    %IncMSE IncNodePurity
FPhysHotPartnerGM 101.95002      85.36262
FPercPopPartnerGM  89.72376      82.40205
FChemisPartnerGM  105.76737      69.08952</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(SampleB_partner.interpmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Post-Interaction-Measures-Predicting-Actor,-Partner,-and-Dyadic-Desire_files/figure-html/unnamed-chunk-1-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>